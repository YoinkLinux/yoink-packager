#!/bin/bash

package_list=()
SKIP_CHECK=false
function check_file(){
    file="$1"
    { tar tvf "$file" .TREE ;} > /dev/null
    tree_status=$?
    if [[ "$tree_status" -ne 0 ]]; then
            echo "Package $file does not have a .TREE file? What are you doing?"
            exit 1
    fi
}

function install_packages(){
    for package in "${package_list}"; do
        [[ ! $SKIP_CHECK ]] && check_file "$package"
        echo "Unpacking $(basename $package)"
        tar xf $package -C /
    done
}

while [[ $# -gt 0 ]]; do
    opt="$1"
    shift;
    case "$opt" in
            "install")
                package_list=$@
                INSTALL=true
                break
                ;;
            "--skip-check")
                    SKIP_CHECK=true
                    ;;
            "extract")
                echo "Method stub."
                break
                ;;
            *)
                echo "Invalid option."
                exit 1
                ;;
    esac
done

[[ $INSTALL ]] && install_packages






